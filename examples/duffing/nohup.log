Available devices: [cuda(id=0)]


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 12
    Maximum number of steps per inner minimization: 10
    Maximum number of outer minimizations: 300
    Maximum total number of training steps: 3000

Compiling function "train_step" for neural ode ...

Compiling function "train_step" for coeffs ...
    Outer Step:     0      Loss: 2.66592693     ValIndCrit: 2.66647696
        Saving best model so far ...
        -NbInnerStepsModel:    1
        -NbInnerStepsCoeffs:    1
        -DiffModel: 3.51e-05
        -DiffCoeffs:  inf
    Outer Step:     1      Loss: 2.66582775     ValIndCrit: 1.82827055
        Saving best model so far ...
        -NbInnerStepsModel:   10
        -NbInnerStepsCoeffs:   10
        -DiffModel: 2.87e-06
        -DiffCoeffs:  1.04e-02
    Outer Step:     2      Loss: 1.70415306     ValIndCrit: 1.54116368
        Saving best model so far ...
        -NbInnerStepsModel:   10
        -NbInnerStepsCoeffs:   10
        -DiffModel: 4.62e-05
        -DiffCoeffs:  1.78e-03
    Outer Step:     3      Loss: 1.52006531     ValIndCrit: 1.43842673
        Saving best model so far ...
        -NbInnerStepsModel:   10
        -NbInnerStepsCoeffs:   10
        -DiffModel: 2.33e-05
        -DiffCoeffs:  8.64e-04
    Outer Step:   100      Loss: 0.01503761     ValIndCrit: 0.07968098
        Saving best model so far ...
        -NbInnerStepsModel:   10
        -NbInnerStepsCoeffs:   10
        -DiffModel: 1.57e-07
        -DiffCoeffs:  3.03e-07
    Outer Step:   200      Loss: 0.00787152     ValIndCrit: 0.01785396
        Saving best model so far ...
        -NbInnerStepsModel:   10
        -NbInnerStepsCoeffs:   10
        -DiffModel: 9.65e-08
        -DiffCoeffs:  1.84e-07
    Outer Step:   299      Loss: 0.00354685     ValIndCrit: 0.00090798
        Saving best model so far ...
        Setting the model to the best one found ...
        -NbInnerStepsModel:   10
        -NbInnerStepsCoeffs:   10
        -DiffModel: 1.76e-08
        -DiffCoeffs:  9.32e-08

Training time: 1 hours 1 mins 45 secs

Total gradient descent training time: 1 hours 1 mins 45 secs
==  Begining in-domain testing ... ==
    Number of training environments: 2
    Length of the testing trajectories: 40
Test Score (In-Domain): 1182.7091

==  Begining in-domain visualisation ... ==
    Environment id: 0
    Trajectory id: 18
    Visualized dimensions: (0, 1)
    Final length of the training trajectories: 40
    Length of the testing trajectories: 40
Testing finished. Figure saved in: ./runs/240511-151804/results.png
