Available devices: [cuda(id=0)]
Data shape: (1, 62, 40, 2)


=== Beginning training with proximal alternating minimization ... ===
    Number of examples in a batch: 62
    Maximum number of steps per inner minimization: 10
    Maximum number of outer minimizations: 1000
    Maximum total number of training steps: 10000

Compiling function "train_step" for neural ode ...

Compiling function "train_step" for coeffs ...
    Epoch:     0      LossTrajs: 1.56862926     LossTerms: [1.5706064701080322, 4.873198509216309, -0.6444177031517029, 0.0, 0.0]
        -NbInnerStepsNode:    1
        -NbInnerStepsCoeffs:    1
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 8.65e-08
        -DiffCoeffs:  inf
    Epoch:     1      LossTrajs: 1.56842256     LossTerms: [1.5257235765457153, 4.872835159301758, -0.6594144701957703, 0.0008970739436335862, 2.011857134220918e-07]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 2.02e-08
        -DiffCoeffs:  1.22e-02
    Epoch:     2      LossTrajs: 1.51938820     LossTerms: [1.480318546295166, 4.873968124389648, -0.6475619077682495, 0.0018772040493786335, 1.9409969809203176e-07]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 5.15e-08
        -DiffCoeffs:  2.64e-03
    Epoch:     3      LossTrajs: 1.47425282     LossTerms: [1.4399365186691284, 4.872648239135742, -0.6485103368759155, 0.002823855960741639, 1.8084185171574063e-07]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 7.36e-08
        -DiffCoeffs:  1.07e-03
    Epoch:   100      LossTrajs: 0.28771156     LossTerms: [0.2852025628089905, 4.294896125793457, -0.7734718322753906, 0.03830914571881294, 1.7643998262428795e-08]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 1.20e-07
        -DiffCoeffs:  4.42e-07
    Epoch:   200      LossTrajs: 0.13218257     LossTerms: [0.12402217835187912, 10.659017562866211, -0.8898882865905762, 0.05195026844739914, 6.153216247639648e-08]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 2.62e-08
        -DiffCoeffs:  8.80e-07
    Epoch:   300      LossTrajs: 0.09248618     LossTerms: [0.08390039205551147, 11.485965728759766, -0.9715980887413025, 0.06384153664112091, 9.115682431115602e-09]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 1.16e-08
        -DiffCoeffs:  8.41e-08
    Epoch:   400      LossTrajs: 0.04762543     LossTerms: [0.03873841464519501, 12.851057052612305, -1.1011279821395874, 0.06844034790992737, 1.3559812828134454e-08]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 2.94e-08
        -DiffCoeffs:  8.56e-08
    Epoch:   500      LossTrajs: 0.03404141     LossTerms: [0.029184969142079353, 8.699170112609863, -0.992919921875, 0.07194873690605164, 2.6442088518763285e-09]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 6.89e-09
        -DiffCoeffs:  1.06e-08
    Epoch:   600      LossTrajs: 0.02688920     LossTerms: [0.023207146674394608, 7.169295787811279, -1.0220063924789429, 0.07309895753860474, 0.0]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:    1
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 4.84e-09
        -DiffCoeffs:  9.67e-09
    Epoch:   700      LossTrajs: 0.00191549     LossTerms: [0.002853779587894678, 3.729877233505249, -1.4017205238342285, 0.07335036993026733, 1.4324871955295748e-08]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 7.72e-09
        -DiffCoeffs:  4.54e-08
    Epoch:   800      LossTrajs: -0.00421586     LossTerms: [0.0005431384779512882, 2.514117479324341, -1.3762123584747314, 0.06570008397102356, 4.426675914714906e-09]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 2.59e-09
        -DiffCoeffs:  2.87e-08
    Epoch:   900      LossTrajs: -0.00564406     LossTerms: [0.00034254477941431105, 2.2185299396514893, -1.624727725982666, 0.05736803635954857, 6.0838187820877465e-09]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 3.54e-09
        -DiffCoeffs:  2.77e-08
    Epoch:   999      LossTrajs: -0.00779481     LossTerms: [0.0003124481299892068, 1.9598915576934814, -2.0918760299682617, 0.049921680241823196, 2.383900721270038e-08]
        -NbInnerStepsNode:   10
        -NbInnerStepsCoeffs:   10
        -InnerToleranceNode: 1.00e-09
        -InnerToleranceCoeffs:  1.00e-08
        -DiffNode: 5.01e-09
        -DiffCoeffs:  2.11e-07

Total gradient descent training time: 2 hours 55 mins 5 secs
Test MSE: 514.27105713
Coeffs: 
	  - Lambdas: 
 [[-3.7498210e-02 -5.5258591e-03]
 [-1.4538020e-02 -2.8325563e-05]
 [-3.2923281e-02 -3.7281618e-02]
 [-4.0187319e-05 -5.5787582e-03]] 

	  - Gammas: 
 [[8.27271119e-02 4.38502102e-05]
 [1.15830044e-04 1.82447225e-01]
 [1.10117355e-04 3.94272851e-04]
 [2.63632664e-05 3.09243696e-05]]
Active coefficients lambda: 
 [[1 0]
 [1 0]
 [1 1]
 [0 0]]
Active coefficients gammas: 
 [[1 0]
 [0 1]
 [0 0]
 [0 0]]

Number of parameters in the model: 6400
Vector field at [1,1]: 
 [[ 1.4804572   0.81339383]
 [ 5.610048   -1.4621122 ]
 [-9.987112    7.2077694 ]
 [-3.0264788   0.36314976]]
Vector field at [2,2]: 
 [[ 2.3488238  1.8193736]
 [ 6.570696  -1.4545121]
 [-8.255913   7.7413883]
 [-3.1364036  1.3177359]]
